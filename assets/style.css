/* Long Horizon Hierarchy â€“ merged, conflict-free stylesheet */
/* Combines themeable variables, responsive nav, hero, highlights, results, resources, bibtex, and footer. */

/* ============================= */
/* Root variables & base theming */
/* ============================= */
:root {
  /* Layout */
  --container-width: 1200px;
  --max-width: 1080px;

  /* Typography */
  --font-body: "DM Sans", "Google Sans", "Segoe UI", sans-serif;
  --font-display: "Space Grotesk", "Google Sans", "Segoe UI", sans-serif;

  /* Motion & shape */
  --transition: 200ms ease;
  --radius-lg: 20px;

  /* Shadows (both naming schemes supported) */
  --shadow-elevated: 0 24px 55px rgba(7, 11, 25, 0.35);
  --shadow-soft: 0 18px 40px rgba(7, 11, 25, 0.2);
  --shadow-lg: 0 24px 48px rgba(0, 0, 0, 0.35);
  --shadow-sm: 0 8px 20px rgba(0, 0, 0, 0.25);
}

/* Dark theme variables */
body[data-theme="dark"] {
  --color-bg: #050913;
  --color-surface: rgba(12, 18, 36, 0.88);
  --color-surface-alt: rgba(12, 20, 40, 0.7);
  --color-section: rgba(6, 12, 28, 0.62);
  --color-border: rgba(255, 255, 255, 0.08);
  --color-text: #edf1ff;
  --color-heading: #ffffff;
  --color-muted: rgba(218, 227, 255, 0.75);
  --color-accent: #7b83ff;
  --color-accent-strong: #8f7bff;
  --color-accent-soft: rgba(123, 131, 255, 0.14);
  --color-hero-gradient: radial-gradient(circle at 10% 10%, #25356d 0%, #0c142a 46%, #050913 100%);
  --color-header: rgba(6, 12, 26, 0.85);
  --color-outline: rgba(123, 131, 255, 0.28);
  --color-button-text: #ffffff;
  --color-footer-bg: rgba(6, 12, 26, 0.92);
  /* Extras used by legacy rules */
  --color-card: #0f1c33;
  color-scheme: dark;
}

/* Light theme variables */
body[data-theme="light"] {
  --color-bg: #f4f6ff;
  --color-surface: rgba(255, 255, 255, 0.9);
  --color-surface-alt: #eef2ff;
  --color-section: rgba(228, 234, 255, 0.65);
  --color-border: rgba(17, 24, 39, 0.12);
  --color-text: #15213c;
  --color-heading: #0b1120;
  --color-muted: rgba(71, 85, 105, 0.8);
  --color-accent: #4c51bf;
  --color-accent-strong: #312e81;
  --color-accent-soft: rgba(76, 81, 191, 0.12);
  --color-hero-gradient: radial-gradient(circle at 5% 25%, #ffffff 0%, #eef2ff 48%, #e0e7ff 100%);
  --color-header: rgba(255, 255, 255, 0.88);
  --color-outline: rgba(76, 81, 191, 0.28);
  --color-button-text: #ffffff;
  --color-footer-bg: rgba(235, 240, 255, 0.85);
  /* Override shadows for light */
  --shadow-elevated: 0 28px 48px rgba(15, 23, 42, 0.16);
  --shadow-soft: 0 18px 38px rgba(15, 23, 42, 0.12);
  --color-card: #ffffff;
  color-scheme: light;
}

/* ================= */
/* Global resets     */
/* ================= */
*,
*::before,
*::after { box-sizing: border-box; }

html { scroll-behavior: smooth; }

body {
  margin: 0;
  font-family: var(--font-body);
  background: var(--color-bg);
  background-color: var(--color-bg);
  color: var(--color-text);
  min-height: 100vh;
  line-height: 1.6;
  transition: background 0.35s ease, color 0.35s ease;
}

main {
  display: flex;
  flex-direction: column;
  gap: 4.5rem;
  padding: 3rem 0 5rem;
}

main section { scroll-margin-top: 96px; }

p { margin: 0 0 1rem; }
ul { margin: 0 0 1.25rem; padding-left: 1.25rem; }
li { margin-bottom: 0.6rem; }

a {
  color: inherit;
  text-decoration: none;
  transition: color var(--transition), opacity var(--transition);
}
a:hover,
a:focus,
a:focus-visible { color: var(--color-accent); }

img,
video { display: block; max-width: 100%; }
iframe { border: 0; }

/* ================= */
/* Layout helpers    */
/* ================= */
.container { width: min(92%, var(--container-width)); margin: 0 auto; }
section { padding: clamp(3rem, 6vw, 5.5rem) 0; }

.section-title {
  font-family: var(--font-display);
  font-size: clamp(2rem, 5vw, 3rem);
  margin: 0 0 0.5rem;
  color: var(--color-heading);
  text-align: center;
}

.section-subtitle {
  font-size: 1.05rem;
  color: var(--color-muted);
  max-width: 720px;
  margin: 0 auto clamp(2rem, 5vw, 3rem);
  text-align: center;
}

/* ================= */
/* Buttons           */
/* ================= */
.button{
  display:inline-flex;align-items:center;justify-content:center;gap:0.45rem;
  padding:0.6rem 1.2rem;border-radius:999px;border:1px solid transparent;
  background:var(--color-accent);color:var(--color-button-text);font-weight:600;letter-spacing:0.02em;
  transition:transform var(--transition),box-shadow var(--transition),border-color var(--transition),background var(--transition);
  box-shadow:var(--shadow-sm);
}
.button .icon{font-size:1.05rem;line-height:1;}
.button:hover,.button:focus,.button:focus-visible{transform:translateY(-1px);box-shadow:0 14px 32px rgba(123,131,255,.35);}
.button.secondary{background:transparent;border-color:var(--color-border);color:var(--color-heading);box-shadow:none;}
.button.secondary:hover,.button.secondary:focus,.button.secondary:focus-visible{border-color:var(--color-accent);color:var(--color-heading);box-shadow:0 12px 28px rgba(123,131,255,.24);}

/* ================= */
/* Header & Nav      */
/* ================= */
.site-header{
  position:sticky;top:0;z-index:1000;background:var(--color-header);
  border-bottom:1px solid var(--color-border);backdrop-filter:blur(18px);
}
.site-header__inner{display:flex;align-items:center;gap:1.5rem;padding:0.9rem 0;position:relative;}
.site-logo,.logo{font-family:var(--font-display);font-weight:600;letter-spacing:.08em;text-transform:uppercase;font-size:.9rem;color:var(--color-heading);}

.menu-toggle{
  display:none;align-items:center;gap:.4rem;padding:.45rem .95rem;border-radius:999px;border:1px solid var(--color-border);
  background:var(--color-surface);color:var(--color-heading);font-weight:600;letter-spacing:.04em;text-transform:uppercase;cursor:pointer;
  transition:border-color var(--transition),background var(--transition),color var(--transition);
}
.menu-toggle:hover,.menu-toggle:focus-visible{border-color:var(--color-accent);color:var(--color-heading);}

.theme-toggle{
  display:inline-flex;align-items:center;gap:.45rem;margin-left:1rem;padding:.45rem .9rem;border-radius:999px;border:1px solid var(--color-border);
  background:var(--color-surface);color:var(--color-heading);font-weight:600;font-size:.85rem;letter-spacing:.03em;text-transform:uppercase;cursor:pointer;
  transition:border-color var(--transition),background var(--transition),color var(--transition),box-shadow var(--transition);
}
.theme-toggle:hover,.theme-toggle:focus-visible{border-color:var(--color-accent);box-shadow:0 12px 32px rgba(123,131,255,.22);}
.theme-toggle__icon{font-size:1rem;line-height:1;}

.site-nav{display:flex;align-items:center;gap:1.75rem;margin-left:auto;font-size:.95rem;}
.site-nav a{
  font-weight:500;letter-spacing:.02em;font-size:.92rem;color:var(--color-muted);padding:.25rem 0;position:relative;
}
.site-nav a::after{
  content:"";position:absolute;left:0;bottom:-.4rem;width:100%;height:2px;border-radius:1px;
  background:linear-gradient(90deg,transparent,var(--color-accent),transparent);
  transform:scaleX(0);transform-origin:center;transition:transform 160ms ease;
}
.site-nav a:hover::after,.site-nav a:focus-visible::after,.site-nav a.is-active::after{transform:scaleX(1);}
.site-nav a.is-active{color:var(--color-heading);}

/* ============ */
/* Hero section */
/* ============ */
.hero{background:var(--color-hero-gradient);padding-top:clamp(4rem,8vw,6.5rem);padding-bottom:clamp(4rem,8vw,6.5rem);border-bottom:1px solid var(--color-border);}
.hero__inner{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:clamp(2.5rem,6vw,4.5rem);align-items:center;}
.hero__eyebrow,.tagline{
  display:inline-block;font-size:.85rem;letter-spacing:.28em;text-transform:uppercase;color:var(--color-accent);
  background:var(--color-accent-soft);padding:.35rem .85rem;border-radius:999px;font-weight:600;
}
.hero__title,.hero h1{font-family:var(--font-display);font-size:clamp(2.6rem,6vw,3.8rem);margin:1rem 0 1.25rem;color:var(--color-heading);line-height:1.12;}
.hero__lead,.hero__subtitle{font-size:1.1rem;color:var(--color-muted);margin:1.5rem 0 2rem;max-width:36ch;}
.hero__meta{display:grid;gap:.5rem;color:var(--color-muted);font-size:.98rem;}
.hero__authors,.authors span{color:var(--color-heading);font-weight:600;margin-inline-start:.4rem;}
.hero__media,.hero__visual{display:grid;gap:1rem;}

/* Video containers */
.video-frame,.video-wrapper{
  position:relative;width:100%;aspect-ratio:16/9;border-radius:20px;overflow:hidden;background:var(--color-section);
  border:1px solid var(--color-border);box-shadow:var(--shadow-elevated);
}
.video-wrapper{padding-bottom:0;height:auto;}
.video-frame iframe,.video-wrapper iframe{position:absolute;inset:0;width:100%;height:100%;border:0;}
.video-caption{font-size:.9rem;color:var(--color-muted);}

.profile-card{background:var(--color-surface);border-radius:var(--radius-lg);border:1px solid var(--color-border);box-shadow:var(--shadow-elevated);overflow:hidden;display:grid;}
.profile-card__image{width:100%;aspect-ratio:1/1;object-fit:cover;}
.profile-card__body{padding:1.35rem;display:grid;gap:.75rem;}
.profile-card__tag{font-size:.8rem;letter-spacing:.24em;text-transform:uppercase;color:var(--color-accent);}
.profile-card__list{margin:0;padding-left:1.1rem;color:var(--color-muted);}
.profile-card__list li{margin-bottom:.45rem;}
.profile-card__list li:last-child{margin-bottom:0;}

/* ============ */
/* Teaser strip */
/* ============ */
.teaser{background:var(--color-section);border-top:1px solid var(--color-border);border-bottom:1px solid var(--color-border);}
.teaser .video-frame{max-width:960px;margin:0 auto;}

/* ================== */
/* Section header row */
/* ================== */
.section-header{display:flex;align-items:flex-end;justify-content:space-between;gap:2rem;margin-bottom:2rem;}
.section-header h2{font-family:var(--font-display);font-size:2rem;margin:0;}
.section-header p{margin:0;color:var(--color-muted);max-width:50ch;}

/* ===================== */
/* Highlights & Abstract */
/* ===================== */
.highlights{margin-top:1rem;}
.highlight-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.5rem;}
.highlight-card{
  padding:1.75rem;border-radius:var(--radius-lg);background:var(--color-surface);border:1px solid var(--color-border);
  box-shadow:var(--shadow-soft);display:grid;gap:.75rem;
}
.highlight-card h3{margin:0;font-family:var(--font-display);color:var(--color-heading);}
.highlight-card p{margin:0;color:var(--color-muted);}
.abstract{background:rgba(3,7,16,.6);padding:3rem 0;border-block:1px solid var(--color-border);}
.abstract .content,.abstract p{max-width:780px;margin:0 auto;font-size:1.05rem;color:var(--color-muted);line-height:1.6;}

/* ================= */
/* Publications area */
/* ================= */
.results{padding:clamp(3rem,6vw,4.5rem) 0;}
.publication-groups{display:grid;gap:clamp(1.75rem,4vw,2.5rem);}
.publication-group{
  position:relative;overflow:hidden;border-radius:var(--radius-lg);border:1px solid var(--color-border);
  background:linear-gradient(135deg,rgba(123,131,255,.12),transparent 45%),var(--color-surface);
  padding:clamp(1.85rem,4vw,2.65rem);box-shadow:var(--shadow-soft);
  transform:translateY(42px);opacity:0;transition:transform .55s cubic-bezier(.21,.78,.35,1),opacity .55s ease;
  transition-delay:calc(var(--animation-index,0)*90ms);
}
.publication-group::before{
  content:'';position:absolute;inset:0;background:radial-gradient(circle at top right,rgba(123,131,255,.25),transparent 55%);
  pointer-events:none;opacity:.8;
}
.publication-group>*{position:relative;z-index:1;}
.publication-group.is-visible{transform:translateY(0);opacity:1;}
.publication-group__header{display:grid;gap:.65rem;margin-bottom:clamp(1.25rem,3vw,1.85rem);}
.publication-group__badge{
  width:fit-content;padding:.4rem .9rem;border-radius:999px;background:rgba(123,131,255,.22);
  color:var(--color-heading);font-weight:600;letter-spacing:.05em;text-transform:uppercase;font-size:.8rem;
}
.publication-group__description{margin:0;color:var(--color-muted);font-size:1rem;max-width:60ch;}
.publication-group__milestone{margin:0;color:var(--color-heading);font-weight:600;font-size:.95rem;}
.publication-list{list-style:none;margin:0;padding:0;display:grid;gap:1.15rem;}
.publication-card{
  border-radius:clamp(1rem,3vw,1.35rem);border:1px solid rgba(255,255,255,.06);background:rgba(12,18,36,.55);
  backdrop-filter:blur(14px);padding:clamp(1.35rem,3.5vw,1.75rem);display:grid;gap:.75rem;
}
body[data-theme='light'] .publication-card{background:rgba(255,255,255,.8);border-color:rgba(49,46,129,.12);}
.publication-card__meta{
  display:flex;flex-wrap:wrap;gap:.65rem;justify-content:space-between;align-items:center;font-size:.85rem;
  letter-spacing:.03em;text-transform:uppercase;color:var(--color-muted);
}
.publication-card__venue{font-weight:600;}
.publication-card__status{padding:.25rem .65rem;border-radius:999px;background:rgba(123,131,255,.2);color:var(--color-heading);font-weight:600;}
.publication-card__title{margin:0;font-family:var(--font-display);font-size:clamp(1.2rem,3vw,1.55rem);color:var(--color-heading);}
.publication-card__authors{margin:0;color:var(--color-muted);font-size:.95rem;}
.publication-card__actions{margin-top:.5rem;display:flex;flex-wrap:wrap;gap:.75rem;}
.publication-card__action{
  display:inline-flex;align-items:center;justify-content:center;gap:.4rem;padding:.45rem 1.25rem;border-radius:999px;
  border:1px solid var(--color-border);background:var(--color-surface-alt);color:var(--color-heading);font-size:.85rem;font-weight:600;
  letter-spacing:.08em;text-transform:uppercase;transition:border-color var(--transition),background var(--transition),color var(--transition),transform var(--transition);
  cursor:pointer;text-decoration:none;
}
a.publication-card__action:hover,a.publication-card__action:focus-visible{border-color:transparent;background:var(--color-accent);color:var(--color-button-text);transform:translateY(-1px);}
button.publication-card__action{font:inherit;background:transparent;}
button.publication-card__action[disabled]{cursor:not-allowed;border-style:dashed;border-color:var(--color-border);color:var(--color-muted);opacity:.7;}
@media (max-width:720px){.publication-card__meta{flex-direction:column;align-items:flex-start;gap:.4rem;}}
@media (prefers-reduced-motion:reduce){.publication-group{transform:none!important;opacity:1!important;transition-duration:.001ms!important;}}

/* ================= */
/* Flagship projects */
/* ================= */
.portfolio{background:var(--color-section);border-top:1px solid var(--color-border);border-bottom:1px solid var(--color-border);}
.project-showcase{display:grid;gap:clamp(1.75rem,4vw,2.5rem);}

.project-case{
  position:relative;overflow:hidden;display:grid;grid-template-columns:minmax(0,1fr) minmax(0,.95fr);
  align-items:stretch;gap:clamp(1.5rem,4vw,2.25rem);padding:clamp(1.75rem,4vw,2.5rem);
  border-radius:var(--radius-lg);border:1px solid color-mix(in srgb,var(--color-border) 55%,transparent);
  background:color-mix(in srgb,var(--color-surface) 72%,rgba(255,255,255,.58));box-shadow:var(--shadow-sm);
  transform:translateY(48px);opacity:0;transition:transform .6s cubic-bezier(.21,.78,.35,1),opacity .6s ease;
  transition-delay:calc(var(--animation-index,0)*110ms);
}
.project-case::before{
  content:'';position:absolute;inset:-20% 15% 55% -25%;
  background:radial-gradient(circle at top left,rgba(123,131,255,.28),transparent 65%),
             radial-gradient(circle at bottom right,rgba(111,225,255,.18),transparent 70%);
  opacity:.45;pointer-events:none;
}
.project-case>*{position:relative;z-index:1;}
.project-case.is-visible{transform:translateY(0);opacity:1;}

/* PROJECT IMAGES â€” show full image (no zoom/crop) */
.project-case__media{
  position:relative;border-radius:calc(var(--radius-lg) - 8px);overflow:hidden;
  aspect-ratio:4/3;max-height:320px;align-self:center;justify-self:stretch;
  display:flex;align-items:center;justify-content:center;
  box-shadow:inset 0 0 0 1px color-mix(in srgb,var(--color-border) 45%, transparent);
  background: var(--color-section); /* neutral behind letterboxing */
}
.project-case__media::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(180deg,rgba(8,12,24,0) 45%, rgba(8,12,24,.18) 100%);
  mix-blend-mode:soft-light;opacity:.55;pointer-events:none;
}
.project-case__media img{
  width:100%;height:100%;
  object-fit:contain;     /* key change from 'cover' -> 'contain' */
  object-position:center;display:block;
}

.project-case__content{display:grid;gap:clamp(1.5rem,4vw,2.35rem);align-content:stretch;}
.project-case__summary{display:grid;gap:clamp(.85rem,2.5vw,1.4rem);}
.project-case__eyebrow{margin:0;font-size:.9rem;letter-spacing:.08em;text-transform:uppercase;color:var(--color-muted);}
.project-case__title{margin:0;font-family:var(--font-display);font-size:clamp(1.75rem,4vw,2.35rem);color:var(--color-heading);}
.project-case__description{margin:0;color:var(--color-text);font-size:1rem;line-height:1.65;max-width:58ch;}
.project-case__details{display:grid;gap:.85rem;align-content:start;align-items:stretch;grid-template-columns:minmax(0,1fr);}
.project-case__meta-block{
  display:grid;grid-template-columns:auto minmax(0,1fr);gap:.75rem;padding:.85rem 1rem;border-radius:.9rem;
  border:1px solid color-mix(in srgb,var(--color-border) 50%,transparent);
  background:color-mix(in srgb,var(--color-surface) 75%, rgba(255,255,255,.35));align-items:start;
}
body[data-theme='light'] .project-case__meta-block{background:rgba(255,255,255,.9);border-color:rgba(49,46,129,.18);}
.project-case__meta-block--accent{background:color-mix(in srgb,rgba(123,131,255,.32) 70%, rgba(255,255,255,.58));border-color:color-mix(in srgb,var(--color-accent) 45%,transparent);}
.project-case__meta-label{font-size:.8rem;letter-spacing:.08em;text-transform:uppercase;color:var(--color-muted);white-space:nowrap;align-self:center;}
.project-case__meta-value{font-size:.96rem;font-weight:600;color:var(--color-heading);}
.project-case__tech-list{
  margin:0;padding:0;list-style:none;display:flex;flex-wrap:wrap;gap:.45rem;justify-content:flex-start;
}
.project-case__tech-list li{padding:.35rem .75rem;border-radius:999px;background:rgba(123,131,255,.16);color:var(--color-heading);font-size:.85rem;font-weight:600;}
.project-case__footnote{display:grid;gap:clamp(1rem,3vw,1.45rem);align-content:start;}
.project-case__cta{
  display:inline-grid;grid-auto-flow:column;align-items:center;justify-content:flex-start;gap:.55rem;padding:.6rem 1.45rem;
  border-radius:999px;border:1px solid color-mix(in srgb,var(--color-accent) 55%,transparent);
  background:linear-gradient(120deg,rgba(123,131,255,.2),rgba(111,225,255,.16));
  color:var(--color-heading);font-size:.82rem;font-weight:700;letter-spacing:.12em;text-transform:uppercase;
  cursor:pointer;transition:transform .4s cubic-bezier(.23,1,.32,1),box-shadow .4s ease,background .4s ease,color .4s ease;
  justify-self:start;
}
.project-case__cta:hover,.project-case__cta:focus-visible{
  transform:translateY(-2px);
  box-shadow:0 18px 40px rgba(29,43,97,.35);
  background:linear-gradient(120deg,rgba(123,131,255,.35),rgba(111,225,255,.28));
}
.project-case__cta:focus-visible{outline:2px solid color-mix(in srgb,var(--color-accent) 65%,transparent);outline-offset:3px;}
.project-case__cta-icon{font-size:1rem;line-height:1;transition:transform .4s cubic-bezier(.25,1,.35,1);}
.project-case__cta-label{font-size:.8rem;letter-spacing:.12em;text-transform:uppercase;}
.project-case__cta.is-active{
  background:linear-gradient(120deg,var(--color-accent),color-mix(in srgb,var(--color-accent) 45%,#6fe1ff));
  color:var(--color-button-text);
  box-shadow:0 24px 45px rgba(21,27,66,.45);
}
.project-case__cta.is-active .project-case__cta-icon{transform:rotate(45deg);}
.project-case__story{
  position:relative;overflow:hidden;border-radius:calc(var(--radius-lg) - 10px);
  border:1px solid color-mix(in srgb,var(--color-accent) 35%,rgba(255,255,255,.4));
  background:linear-gradient(140deg,rgba(18,24,51,.92) 0%,rgba(35,47,94,.78) 100%);
  box-shadow:0 28px 60px rgba(6,10,26,.55);
  padding:clamp(1.4rem,4vw,1.85rem);
  max-height:0;
  transition:max-height .55s cubic-bezier(.25,.9,.25,1),opacity .45s ease,transform .55s cubic-bezier(.25,.9,.25,1);
  opacity:0;transform:translateY(18px);pointer-events:none;
}
.project-case.is-expanded .project-case__story{opacity:1;transform:translateY(0);pointer-events:auto;}
.project-story{display:grid;gap:clamp(.75rem,2.4vw,1.1rem);}
.project-story__tag{margin:0;font-size:.78rem;letter-spacing:.14em;text-transform:uppercase;color:rgba(196,204,255,.78);}
.project-story__title{margin:0;font-size:clamp(1.3rem,3vw,1.6rem);font-family:var(--font-display);color:#f4f6ff;}
.project-story__grid{display:grid;gap:clamp(.75rem,2vw,1rem);}
@media (min-width:720px){.project-story__grid{grid-template-columns:repeat(auto-fit,minmax(220px,1fr));}}
.project-story__section{position:relative;padding:clamp(.85rem,2.4vw,1.15rem);border-radius:.95rem;background:color-mix(in srgb,rgba(123,131,255,.28) 65%,rgba(9,14,34,.9));border:1px solid rgba(123,131,255,.28);box-shadow:inset 0 0 0 1px rgba(123,131,255,.18);}
.project-story__section h5{margin:0 0 .35rem;font-size:.9rem;letter-spacing:.08em;text-transform:uppercase;color:rgba(200,205,255,.78);}
.project-story__section p{margin:0;color:rgba(232,236,255,.88);line-height:1.65;}
.project-story__closing{margin:0;font-family:var(--font-display);font-size:1rem;color:#fdfdff;letter-spacing:.02em;}
body[data-theme='light'] .project-case__story{
  background:linear-gradient(145deg,rgba(255,255,255,.96) 0%,rgba(232,237,255,.9) 100%);
  border:1px solid rgba(76,81,191,.28);
  box-shadow:0 18px 36px rgba(76,81,191,.22);
}
body[data-theme='light'] .project-story__title{color:var(--color-heading);}
body[data-theme='light'] .project-story__section{background:color-mix(in srgb,rgba(123,131,255,.16) 55%,rgba(255,255,255,.92));border-color:rgba(76,81,191,.22);box-shadow:none;}
body[data-theme='light'] .project-story__section h5{color:rgba(76,81,191,.72);}
body[data-theme='light'] .project-story__section p{color:rgba(30,36,62,.78);}
body[data-theme='light'] .project-story__closing{color:var(--color-heading);}
body[data-theme='light'] .project-case__cta{background:linear-gradient(120deg,rgba(123,131,255,.18),rgba(111,225,255,.12));color:var(--color-heading);}

@media (max-width:1100px){.project-case{grid-template-columns:minmax(0,1.1fr) minmax(0,1fr);}}
@media (max-width:960px){
  .project-case{grid-template-columns:1fr;}
  .project-case__media{width:100%;max-height:none;}
  .project-case__content{gap:clamp(1.2rem,5vw,2rem);}
}
@media (max-width:640px){
  .project-case__details{grid-template-columns:1fr;}
  .project-case__media{width:100%;}
  .project-case__meta-block{padding:.85rem 1rem;}
}
@media (prefers-reduced-motion:reduce){.project-case{transform:none!important;opacity:1!important;transition-duration:.001ms!important;}}

/* ===================== */
/* Extracurricular cards */
/* ===================== */
.extracurriculars{
  background:linear-gradient(135deg,color-mix(in srgb,var(--color-section) 70%,rgba(123,131,255,.2)) 0%,color-mix(in srgb,var(--color-section) 55%,rgba(111,225,255,.18)) 100%);
  border-block:1px solid color-mix(in srgb,var(--color-border) 65%,transparent);position:relative;overflow:hidden;
}
.extracurriculars::before{
  content:"";position:absolute;inset:0;background:radial-gradient(circle at 12% -8%,rgba(123,131,255,.25),transparent 55%),
            radial-gradient(circle at 82% 105%,rgba(111,225,255,.22),transparent 60%);pointer-events:none;mix-blend-mode:soft-light;
}
.extracurriculars .container{position:relative;z-index:1;}

.extracurriculars__masonry{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:clamp(1.75rem,4vw,2.5rem);}
.extracurricular-card{
  --easing:cubic-bezier(.22,1,.36,1);
  position:relative;display:grid;grid-template-rows:auto 1fr;background:color-mix(in srgb,var(--color-surface) 90%,rgba(255,255,255,.05));
  border-radius:calc(var(--radius-lg) + 6px);border:1px solid color-mix(in srgb,var(--color-border) 55%,transparent);box-shadow:var(--shadow-soft);
  padding:clamp(1.5rem,3.5vw,2.25rem);overflow:hidden;transform:translateY(32px);opacity:0;animation:card-float .9s var(--easing) forwards;
  animation-delay:calc(var(--index,0)*.12s);backdrop-filter:blur(14px);min-height:clamp(22rem,40vw,24rem);
}
.extracurricular-card::after{content:"";position:absolute;inset:0;pointer-events:none;background:linear-gradient(120deg,rgba(123,131,255,.12),rgba(8,12,24,.22));opacity:0;transition:opacity 250ms var(--easing);}
.extracurricular-card__media{
  position:relative;width:100%;border-radius:calc(var(--radius-lg) - 2px);overflow:hidden;aspect-ratio:4/3;
  box-shadow:inset 0 0 0 1px color-mix(in srgb,var(--color-border) 40%,transparent);margin:0 0 clamp(1.25rem,3vw,1.75rem);
  display:flex;align-items:center;justify-content:center;padding:clamp(.65rem,2vw,1rem);
}
.extracurricular-card__media img{
  width:clamp(70%,82%,88%);max-height:100%;object-fit:contain;object-position:center;filter:saturate(1.08);
  transform:scale(.88);transition:transform 450ms var(--easing),filter 450ms var(--easing);margin:0 auto;border-radius:clamp(12px,2vw,18px);
}
.extracurricular-card__body{display:grid;gap:clamp(.85rem,2vw,1.25rem);align-content:start;}
.extracurricular-card__tag{margin:0;font-size:.9rem;letter-spacing:.04em;text-transform:uppercase;color:color-mix(in srgb,var(--color-accent) 70%,var(--color-muted));}
.extracurricular-card__title{margin:0;font-family:var(--font-display);font-size:clamp(1.15rem,2.5vw,1.45rem);color:var(--color-heading);}
.extracurricular-card__copy{margin:0;color:var(--color-muted);font-size:.95rem;}
.extracurricular-card:hover::after,.extracurricular-card:focus-within::after{opacity:1;}
.extracurricular-card:hover .extracurricular-card__media img,.extracurricular-card:focus-within .extracurricular-card__media img{transform:scale(.98);filter:saturate(1.18);}
@keyframes card-float{0%{transform:translateY(32px);opacity:0;}100%{transform:translateY(0);opacity:1;}}
@media (max-width:960px){.extracurriculars__masonry{grid-template-columns:minmax(0,1fr);} .extracurricular-card{padding:clamp(1.35rem,4vw,1.85rem);min-height:auto;}}
@media (max-width:640px){.extracurriculars__masonry{gap:1.35rem;} .extracurricular-card__body{gap:.75rem;}}

/* ===================== */
/* Contact mini section  */
/* ===================== */
.contact-mini{background:var(--color-section);border-top:1px solid var(--color-border);border-bottom:1px solid var(--color-border);}
.contact-mini__inner{display:grid;gap:clamp(1.5rem,4vw,3rem);align-items:center;grid-template-columns:minmax(0,1fr) minmax(0,1fr);}
.contact-mini__copy .section-title,.contact-mini__copy .section-subtitle{text-align:left;margin-left:0;}
.contact-mini__actions{display:grid;gap:1rem;justify-items:start;}
.contact-chip{
  display:inline-flex;flex-direction:column;gap:.35rem;padding:.85rem 1.15rem;border-radius:1rem;border:1px solid var(--color-border);
  background:color-mix(in srgb,var(--color-surface) 92%,transparent);box-shadow:var(--shadow-sm);
  transition:transform var(--transition),box-shadow var(--transition),border-color var(--transition);
}
.contact-chip__label{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:color-mix(in srgb,var(--color-muted) 80%,var(--color-heading));}
.contact-chip__value{font-size:1.05rem;color:var(--color-heading);font-weight:600;}
.contact-chip:hover,.contact-chip:focus-visible{transform:translateY(-2px);box-shadow:var(--shadow-soft);border-color:var(--color-accent);}
.contact-mini__links{display:inline-flex;align-items:center;gap:.65rem;color:var(--color-muted);font-weight:500;}
.contact-mini__links a{color:var(--color-heading);font-weight:600;}
.contact-mini__links a:hover,.contact-mini__links a:focus-visible{color:var(--color-accent);}
@media (max-width:960px){
  .contact-mini__inner{grid-template-columns:1fr;}
  .contact-mini__copy .section-title,.contact-mini__copy .section-subtitle{text-align:center;}
  .contact-mini__actions{justify-items:center;}
}

/* ============== */
/* Footer & Back  */
/* ============== */
.site-footer{background:var(--color-footer-bg);border-top:1px solid var(--color-border);padding:2.5rem 0;color:var(--color-muted);}
.site-footer .container{display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;align-items:center;}
.site-footer p{margin:0 0 .75rem;color:var(--color-muted);text-align:center;}
.back-to-top{
  display:inline-flex;align-items:center;gap:.35rem;padding:.45rem .85rem;border-radius:999px;border:1px solid var(--color-border);
  color:var(--color-heading);transition:border-color var(--transition),color var(--transition),background var(--transition);text-align:center;
}
.back-to-top:hover,.back-to-top:focus,.back-to-top:focus-visible{color:var(--color-heading);border-color:var(--color-accent);background:var(--color-accent-soft);}

/* ================= */
/* Responsive rules  */
/* ================= */
@media (max-width:1080px){
  .hero__inner,.architecture__grid,.architecture__content{grid-template-columns:minmax(0,1fr);}
  .theme-toggle{margin-left:0;}
}
@media (max-width:960px){
  .site-nav{
    display:none;position:absolute;top:calc(100% + .75rem);right:0;width:min(280px,82vw);
    flex-direction:column;align-items:stretch;padding:.75rem;border-radius:1rem;background:var(--color-surface);
    border:1px solid var(--color-border);box-shadow:var(--shadow-elevated);
  }
  .site-nav.is-open{display:flex;}
  .site-nav a{padding:.65rem .75rem;border-radius:.75rem;color:var(--color-heading);}
  .site-nav a::after{display:none;}
  .site-nav a:hover,.site-nav a:focus-visible,.site-nav a.is-active{background:var(--color-accent-soft);}
  .menu-toggle{display:inline-flex;margin-left:auto;}
  .theme-toggle{order:3;}
}
@media (max-width:840px){
  .site-header{gap:1rem;}
  .site-nav.is-open{max-height:400px;padding-top:.5rem;}
}
@media (max-width:720px){
  section{padding:clamp(2.5rem,8vw,4rem) 0;}
  .button-group{justify-content:flex-start;}
  .highlight-grid,.results__grid,.result-grid,.long-horizon__grid,.resource-grid{grid-template-columns:minmax(0,1fr);}
  .site-footer .container{flex-direction:column;align-items:flex-start;}
}
@media (max-width:600px){
  .hero__lead,.hero__subtitle{max-width:unset;}
  main{gap:3.5rem;}
  .section-header{flex-direction:column;align-items:flex-start;gap:1rem;}
}
@media (max-width:540px){
  .hero__title,.hero h1{font-size:clamp(2.2rem,8vw,2.6rem);}
  .hero__inner{gap:2.25rem;}
}

/* =================== */
/* Research timeline   */
/* =================== */
.timeline-section{padding:4.5rem 0;}
.timeline{
  position:relative;max-width:1120px;margin:0 auto clamp(3rem,6vw,3.5rem);
}
.timeline::after{
  content:'';position:absolute;top:0;bottom:clamp(3rem,6vw,3.5rem);left:50%;transform:translateX(-50%);
  width:4px;background:linear-gradient(180deg,var(--color-accent-soft) 0%,var(--color-accent) 45%,var(--color-accent-soft) 100%);opacity:.8;
}
.timeline-item{
  position:relative;width:50%;padding:0 clamp(2rem,4vw,2.5rem) clamp(2.25rem,5vw,2.5rem);
  display:flex;justify-content:flex-end;opacity:0;transform:translateY(48px);
  transition:transform .6s ease,opacity .6s ease;transition-delay:calc(var(--animation-index,0)*.12s);
}
.timeline-item.is-visible{opacity:1;transform:translateY(0);}
.timeline-item:last-child{padding-bottom:0;}
.timeline-item:nth-child(odd){
  left:0;text-align:left;padding-right:clamp(2.25rem,5vw,3rem);padding-left:clamp(1rem,3vw,1.75rem);
}
.timeline-item:nth-child(even){
  left:50%;justify-content:flex-start;padding-left:clamp(2.25rem,5vw,3rem);padding-right:clamp(1rem,3vw,1.75rem);
}
.timeline-item:nth-child(odd) .timeline-image,.timeline-item:nth-child(odd) .timeline-content{margin-right:clamp(.75rem,2vw,1.25rem);}
.timeline-item:nth-child(even) .timeline-image,.timeline-item:nth-child(even) .timeline-content{margin-left:clamp(.75rem,2vw,1.25rem);}

.timeline-item::before{
  content:'';position:absolute;top:24px;width:16px;height:16px;border-radius:50%;border:3px solid var(--color-accent);
  background:var(--color-bg);box-shadow:0 0 0 4px rgba(123,131,255,.12);z-index:1;
}
.timeline-item:nth-child(odd)::before{right:-8px;}
.timeline-item:nth-child(even)::before{left:-8px;}

/* LOGO PANEL â€” no padding, clipped, uniform sizing */
.timeline-content{
  position:relative;background:var(--color-surface);border:1px solid var(--color-border);
  border-radius:var(--radius-lg);padding:0;box-shadow:var(--shadow-soft);display:grid;gap:0;overflow:hidden;width:min(100%,560px);
}
.timeline-image{
  width:100%;height:clamp(95px,16vw,125px);
  margin:0;padding:0;border-bottom:1px solid var(--color-border);background:var(--color-section);
  display:flex;align-items:center;justify-content:center;border-top-left-radius:inherit;border-top-right-radius:inherit;overflow:hidden;isolation:isolate;
  position:relative;z-index:1;transition:filter .45s ease,opacity .45s ease;
}
.timeline-image img{
  display:block;object-fit:contain;max-width:86%;max-height:78%;width:auto;height:auto;background:transparent;
  mix-blend-mode:multiply;image-rendering:-webkit-optimize-contrast;
}

.timeline-body{
  padding:1.15rem;display:grid;gap:.65rem;position:relative;z-index:1;
  transition:filter .45s ease,opacity .45s ease,transform .45s ease;
}
.timeline-meta{margin:0;font-size:.9rem;letter-spacing:.01em;color:var(--color-muted);}
.timeline-content h3{margin:0;font-size:1.18rem;font-family:var(--font-display);color:var(--color-heading);}
.timeline-description{margin:0;color:var(--color-text);}

.timeline-content.has-reveal{
  overflow:visible;cursor:pointer;perspective:1400px;isolation:isolate;
  transition:transform .65s cubic-bezier(.22,1,.36,1),box-shadow var(--transition),border-color var(--transition);
  transform-style:preserve-3d;
  --timeline-reveal-max-width:min(calc(100vw - clamp(2rem,8vw,12rem)),1600px);
  --timeline-reveal-max-height:min(760px,calc(100vh - clamp(4rem,12vh,6rem)));
}
.timeline-content.has-reveal.is-active{
  transform:translateY(-6px) scale(1.01);
  border-color:rgba(123,131,255,.4);
  box-shadow:0 38px 85px rgba(4,8,22,.62);
  z-index:1201;
}
.timeline-content.has-reveal:focus-visible{outline:2px solid var(--color-accent);outline-offset:6px;}

.timeline-hover-glow{
  position:absolute;inset:-14%;border-radius:calc(var(--radius-lg)*1.35);
  background:radial-gradient(circle at 24% 18%,rgba(126,137,255,.42) 0%,rgba(126,137,255,0) 60%),
    radial-gradient(circle at 78% 82%,rgba(126,137,255,.28) 0%,rgba(126,137,255,0) 55%);
  opacity:0;transform:scale(.8);transition:opacity .7s ease,transform .7s ease;z-index:0;pointer-events:none;
  filter:blur(0);
}
.timeline-content.has-reveal.is-active .timeline-hover-glow{opacity:1;transform:scale(1);}

.timeline-content.has-reveal.is-active .timeline-image,
.timeline-content.has-reveal.is-active .timeline-body{
  filter:none;
  opacity:1;
}

.timeline-reveal{
  position:fixed;
  top:50%;
  left:50%;
  width:var(--timeline-reveal-max-width);
  max-width:100vw;
  max-height:var(--timeline-reveal-max-height);
  background:linear-gradient(135deg,rgba(21,33,68,.88) 0%,rgba(13,19,42,.82) 40%,rgba(20,11,43,.92) 100%);
  border-radius:calc(var(--radius-lg) - 10px);
  border:1px solid rgba(123,131,255,.35);
  box-shadow:0 42px 110px rgba(6,10,28,.78);
  transform:translate(-50%,-46%) scale(.9) rotateX(-6deg);
  transform-origin:center;
  opacity:0;
  filter:blur(18px);
  pointer-events:none;
  transition:transform .75s cubic-bezier(.2,.8,.2,1.05),opacity .45s ease,filter .6s ease;
  display:grid;
  z-index:1202;
  color:var(--color-heading);
  backdrop-filter:blur(22px);
  will-change:transform,opacity,filter;
}
.timeline-reveal-overlay{
  position:fixed;
  inset:0;
  background:linear-gradient(140deg,rgba(5,9,20,.48) 0%,rgba(12,18,38,.45) 38%,rgba(6,10,22,.6) 100%);
  backdrop-filter:blur(28px) saturate(120%);
  opacity:0;
  pointer-events:none;
  transition:opacity .45s ease;
  z-index:1200;
}
body.timeline-reveal-active{
  overflow:hidden;
}
body.timeline-reveal-active .timeline-reveal-overlay{
  opacity:1;
  pointer-events:auto;
}
.timeline-content.has-reveal.is-active .timeline-reveal{
  transform:translate(-50%,-50%) scale(1);
  opacity:1;
  filter:blur(0);
  pointer-events:auto;
  animation:timelineRevealPop .6s cubic-bezier(.19,.85,.22,1.08) forwards;
}
.timeline-reveal__close{
  position:absolute;
  top:clamp(.75rem,2vw,1.1rem);
  right:clamp(.75rem,2vw,1.1rem);
  width:clamp(2.25rem,4vw,2.65rem);
  height:clamp(2.25rem,4vw,2.65rem);
  border-radius:999px;
  border:1px solid rgba(186,195,255,.35);
  background:rgba(26,32,68,.5);
  color:transparent;
  display:grid;
  place-items:center;
  cursor:pointer;
  transition:opacity .3s ease,transform .3s ease,background .3s ease,border-color .3s ease;
  opacity:0;
  transform:scale(.85);
  pointer-events:none;
  z-index:5;
}
.timeline-reveal__close::before,
.timeline-reveal__close::after{
  content:'';
  width:55%;
  height:2px;
  background:rgba(224,229,255,.85);
  border-radius:999px;
}
.timeline-reveal__close::before{transform:rotate(45deg);}
.timeline-reveal__close::after{transform:rotate(-45deg);}
.timeline-content.has-reveal.is-active .timeline-reveal__close{
  opacity:1;
  transform:scale(1);
  pointer-events:auto;
}
.timeline-reveal__close:hover,
.timeline-reveal__close:focus-visible{
  background:rgba(42,52,110,.85);
  border-color:rgba(205,214,255,.6);
}
.timeline-reveal__close:focus-visible{
  outline:2px solid rgba(137,148,255,.65);
  outline-offset:2px;
}

@media (hover:hover){
  .timeline-content.has-reveal.is-active .timeline-reveal{
    border-radius:clamp(22px,4vw,32px);
    box-shadow:0 54px 140px rgba(4,7,18,.82);
    backdrop-filter:blur(30px);
  }

  .timeline-content.has-reveal.is-active .timeline-reveal__inner{
    padding:clamp(1.6rem,3vw,2.3rem);
    gap:clamp(.9rem,2.4vw,1.2rem);
    font-size:1.04rem;
    line-height:1.74;
    max-height:var(--timeline-reveal-max-height);
  }
}

.timeline-reveal__inner{
  padding:clamp(1.8rem,4vw,2.35rem) clamp(1.4rem,3.6vw,2rem) clamp(1.7rem,4vw,2.2rem);
  max-height:min(460px,68vh);
  overflow:auto;
  display:grid;
  gap:clamp(.75rem,2vw,1rem);
  font-size:.97rem;
  line-height:1.64;
}
.timeline-reveal__inner::-webkit-scrollbar{width:6px;}
.timeline-reveal__inner::-webkit-scrollbar-thumb{
  background:rgba(123,131,255,.35);border-radius:999px;
}
.timeline-reveal__tag{
  margin:0;font-size:.82rem;letter-spacing:.12em;text-transform:uppercase;color:rgba(196,204,255,.82);
}
.timeline-reveal__title{
  margin:0;font-family:var(--font-display);font-size:1.32rem;color:#f5f6ff;
}
.timeline-reveal__section{display:grid;gap:.45rem;}
.timeline-reveal__section h5{
  margin:0;font-size:.88rem;letter-spacing:.1em;text-transform:uppercase;color:rgba(200,205,255,.72);
}
.timeline-reveal__section p{margin:0;color:rgba(230,235,255,.9);}
.timeline-reveal__closing{
  margin:0;font-weight:600;font-family:var(--font-display);
  font-size:1.02rem;color:#fdfdff;letter-spacing:.015em;
}

@keyframes timelineRevealPop{
  0%{
    transform:translate(-50%,-46%) scale(.88) rotateX(-8deg);
    opacity:0;
    filter:blur(18px);
  }
  60%{
    transform:translate(-50%,-52%) scale(1.03) rotateX(0deg);
    opacity:1;
    filter:blur(4px);
  }
  100%{
    transform:translate(-50%,-50%) scale(1) rotateX(0deg);
    opacity:1;
    filter:blur(0);
  }
}

body[data-theme="light"] .timeline-content.has-reveal .timeline-reveal{
  background:linear-gradient(140deg,rgba(255,255,255,.96) 0%,rgba(232,237,255,.92) 100%);
  border:1px solid rgba(76,81,191,.28);
  box-shadow:0 28px 60px rgba(76,81,191,.25);
  color:var(--color-heading);
}
body[data-theme="light"] .timeline-reveal-overlay{
  background:linear-gradient(140deg,rgba(244,246,255,.58) 0%,rgba(226,230,255,.52) 40%,rgba(212,220,255,.64) 100%);
  backdrop-filter:blur(24px) saturate(130%);
}
body[data-theme="light"] .timeline-reveal__title{color:var(--color-heading);}
body[data-theme="light"] .timeline-reveal__section h5{color:rgba(76,81,191,.75);}
body[data-theme="light"] .timeline-reveal__section p{color:rgba(17,24,39,.75);}
body[data-theme="light"] .timeline-reveal__closing{color:var(--color-heading);}

@media (hover:none) and (pointer:coarse){
  .timeline-content.has-reveal{cursor:default;}
  .timeline-content.has-reveal .timeline-hover-glow{display:none;}
  .timeline-content.has-reveal .timeline-image,
  .timeline-content.has-reveal .timeline-body{
    opacity:1;filter:none;transform:none;
  }
  .timeline-content.has-reveal .timeline-reveal{
    position:static;
    transform:none;
    opacity:1;
    pointer-events:auto;
    box-shadow:none;
    border-radius:calc(var(--radius-lg) - 6px);
    background:var(--color-surface-alt);
    border:1px solid var(--color-border);
    backdrop-filter:none;
    margin:0 clamp(1rem,4vw,1.5rem) clamp(1rem,4vw,1.5rem);
  }
  .timeline-reveal__inner{max-height:none;}
  .timeline-reveal__close{display:none;}
}

@media (max-width:960px){
  .timeline-section{padding:3.5rem 0;}
  .timeline::after{left:24px;transform:none;bottom:clamp(2.5rem,10vw,3rem);}
  .timeline-item{width:100%;padding:0 0 2.25rem 3.5rem;display:block;}
  .timeline-item:nth-child(odd){padding-left:3.5rem;padding-right:0;}
  .timeline-item:last-child{padding-bottom:0;}
  .timeline-item:nth-child(even){left:0;padding-left:3.5rem;padding-right:0;}
  .timeline-item::before{left:8px;}
  .timeline-item:nth-child(odd) .timeline-image,
  .timeline-item:nth-child(odd) .timeline-content,
  .timeline-item:nth-child(even) .timeline-image,
  .timeline-item:nth-child(even) .timeline-content{margin-left:0;margin-right:0;}

  .timeline-image{height:clamp(90px,24vw,120px);}
  .timeline-content{width:100%;}
}
@media (prefers-reduced-motion:reduce){
  .timeline-item{transition:none;transform:none;opacity:1;}
  .timeline-content.has-reveal{
    transition:none;
    transform:none;
  }
  .timeline-content.has-reveal .timeline-image,
  .timeline-content.has-reveal .timeline-body,
  .timeline-content.has-reveal .timeline-reveal{
    transition:none;
    animation:none!important;
  }
  .timeline-content.has-reveal.is-active .timeline-reveal{
    transform:none;
    opacity:1;
    filter:none;
    animation:none!important;
  }
}

/* ============================ */
/* Research Reveal â€“ Final Pass */
/* ============================ */

/* Highest stacking to avoid timeline/header bleed-through */
.timeline-reveal-overlay{ z-index: 9997 !important; }
.timeline-reveal{ z-index: 9999 !important; }
.site-header, .site-nav, .timeline, .timeline-item, .timeline-content{ z-index: initial; }

/* Overlay: theme-aware dim, no blur */
.timeline-reveal-overlay{
  position: fixed; inset: 0;
  background: rgba(10,14,28,.48);
  opacity: 0; pointer-events: none;
  transition: opacity .24s ease-out;
  filter: none !important;
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;
}
body[data-theme="light"] .timeline-reveal-overlay{ background: rgba(0,8,24,.22); }
body[data-theme="dark"]  .timeline-reveal-overlay{ background: rgba(2,6,18,.55); }

/* Panel: no blur; responsive width/height that work at any zoom */
:root{
  --reveal-min-w: 720px;
  --reveal-ideal-w: 900px;
  --reveal-max-w: 1040px;
  --reveal-gap: clamp(16px, 2.6vmin, 24px);
  --reveal-radius: clamp(14px, 1.8vmin, 18px);
}
.timeline-reveal{
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%,-50%);
  width: clamp(var(--reveal-min-w), 86vw, var(--reveal-max-w));
  max-width: 96vw;
  max-height: calc(94dvh - var(--reveal-gap)*2);
  border-radius: var(--reveal-radius);
  border: 1px solid color-mix(in srgb, var(--color-border), var(--color-accent) 28%);
  background: linear-gradient(135deg, rgba(18,24,54,.97), rgba(12,16,36,.96));
  box-shadow:
    0 42px 120px rgba(4, 7, 18, .70),
    0 16px 34px rgba(4, 7, 18, .35);
  color: var(--color-heading);
  opacity: 0; pointer-events: none;
  filter: none !important;
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;
  will-change: transform, opacity;
}

/* Active states */
body.timeline-reveal-active .timeline-reveal-overlay{
  opacity: 1; pointer-events: auto;
}
.timeline-content.has-reveal.is-active .timeline-reveal{
  opacity: 1; pointer-events: auto;
}

/* Inner scroll container â€“ always tall enough to scroll */
.timeline-reveal__inner{
  padding: clamp(20px, 2.8vmin, 28px);
  max-height: calc(90dvh - var(--reveal-gap)*2);
  overflow: auto;
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}
/* Larger readable text */
.timeline-reveal__inner,
.timeline-reveal__narrative{ font-size: 0.98rem; line-height: 1.72; }

/* Keep jiggle/hover effects visible when modal closed */
.timeline-content .timeline-hover-glow{ pointer-events: none; }
.timeline-content{ transform-style: preserve-3d; }

/* Hover state bounce + tilt restored */
.timeline-content.is-hovered{
  transform: translateY(-6px) scale(1.01) rotateX(var(--tiltX, 0deg)) rotateY(var(--tiltY, 0deg));
  box-shadow: var(--shadow-elevated);
}

/* Close button visible and unambiguous */
.timeline-reveal__close{
  position: absolute; top: 14px; right: 14px;
  width: 40px; height: 40px;
  border-radius: 999px;
  border: 1px solid color-mix(in srgb, var(--color-border), var(--color-accent) 30%);
  background: rgba(34,40,80,.45);
  display: grid; place-items: center;
  opacity: 1; transform: none; pointer-events: auto;
}
.timeline-reveal__close::before, .timeline-reveal__close::after{
  content: ''; width: 18px; height: 2px;
  background: rgba(226,232,255,.92); border-radius: 2px;
  position: absolute;
}
.timeline-reveal__close::before{ transform: rotate(45deg); }
.timeline-reveal__close::after{ transform: rotate(-45deg); }
.timeline-reveal__close:hover{ background: rgba(50,60,120,.6); }

/* Narrative: organic, no block section headings */
.timeline-reveal__narrative b{ font-weight: 700; }
.timeline-reveal__tag{ display: none !important; } /* optional: remove tag line if you want it cleaner */

/* Accessibility: focus ring inside dialog */
.timeline-reveal :focus-visible{ outline: 2px solid rgba(136,148,255,.7); outline-offset: 3px; }

/* Prevent any legacy keyframe pops interfering with morph */
.timeline-content.has-reveal .timeline-reveal{ animation: none !important; filter: none !important; }

/* === Final polish: stronger separation, visibility guard, smoother scroll === */
.timeline-reveal{
  background: linear-gradient(135deg, rgba(16,22,46,.985), rgba(10,14,32,.98)) !important;
  visibility: hidden;
}
.timeline-content.has-reveal.is-active .timeline-reveal{
  visibility: visible;
}

/* Stronger overlay for clarity on light mode */
body[data-theme="light"] .timeline-reveal-overlay{ background: rgba(6,10,24,.35) !important; }

/* Ensure inner always scrolls; a tiny padding to avoid last-line cut-offs */
.timeline-reveal__inner{ padding-bottom: max(16px, env(safe-area-inset-bottom)); }
